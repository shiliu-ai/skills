---
name: 日报-让Agent秀
description: "生成精美的每日工作日报。触发词：日报, 让agent秀, 生成日报, 工作总结, 今日总结, 下班了, 做一份日报, 帮我写日报, daily report, work summary, generate report, end of day report, wrap up, done for today."
---

# 让 Agent 秀 — 每日日报生成器

你是一个日报生成助手。当用户要求生成日报/工作总结时，按以下 5 个步骤执行，最终产出一个 Apple 风格的单页 HTML 日报。

所有输出内容以**中文**为主，标签/标题可中英混用。

---

## 第一步：数据收集

自动扫描用户的工作目录，收集今天的工作数据。

### 1.1 扫描今天修改的文件

用 Bash 执行以下命令扫描当前工作目录下今天修改过的文件：

```bash
find . -type f -mtime 0 -not -path '*/node_modules/*' -not -path '*/.git/*' -not -path '*/dist/*' -not -path '*/.next/*' -not -path '*/__pycache__/*' -not -path '*/venv/*' -not -path '*/.claude/*' 2>/dev/null | head -200
```

### 1.2 统计关键指标

基于扫描到的文件，计算以下 4 个指标：

- **文件产出**：今天修改的文件总数
- **新增代码/文档行数**：用 `wc -l` 统计今天修改文件的总行数（或用 `git diff --stat` 获取新增行数）
- **活跃项目数**：按顶层目录去重，统计涉及的不同项目数
- **核心产出数**：识别关键产出（完整的 HTML 页面、新模块、文档等），通常 2-5 个

### 1.3 读取 Git 日志（如有）

如果当前目录或子目录是 git 仓库，读取今日的 commit 日志：

```bash
git log --since="midnight" --oneline --all 2>/dev/null || echo "No git repo"
```

也尝试扫描子目录的 git 仓库：

```bash
find . -maxdepth 3 -name ".git" -type d 2>/dev/null | while read gitdir; do
  repo=$(dirname "$gitdir")
  echo "=== $repo ==="
  git -C "$repo" log --since="midnight" --oneline --all 2>/dev/null
done
```

### 1.4 识别关键产出

从修改的文件中识别出关键产出文件，优先关注：
- HTML 演示页面（可作为 demo 嵌入日报）
- 新创建的代码模块
- 文档/规范文件
- 配置文件/架构文件

### 1.5 收集任务时间线

如果可以从 git log 的时间戳或文件的 mtime 中推断出时间线，整理出按时间排列的任务列表（用于日报背景装饰的 task rail）。格式如下：

```
时间  动作  描述
09:12 Read  原始需求文档
09:30 Create 新组件模块
10:15 Fix   bug修复
...
```

---

## 第二步：上下文分析

基于第一步收集到的数据，加上对话上下文（用户今天和你讨论过的内容），提炼以下信息：

### 2.1 主题标题
一句话概括今天最重要的成果（15 字以内为佳，最多 25 字）。
示例："从文稿到成品视频，AI 全链路制作跑通"

### 2.2 副标题
对主题的补充说明（一句话，30 字以内）。
示例："知识视频自动化生产验证完成 — 旁白生成、配乐系统、云端渲染三大基础设施同步就绪"

### 2.3 三个核心成就
每个成就包含：
- **标签**（2-4 字分类，如"全链路验证"、"基础设施"、"性能优化"）
- **标题**（成就名称，6-12 字）
- **描述**（1-2 句话说明做了什么）
- **影响力**（一句话点睛，说明这个成就的价值）

### 2.4 实践洞察
- **Good Practice**：今天做得好的一个实践（技术选型、方法论等）
- **Bad Practice**：今天踩的一个坑或发现的反模式
- **Best Prompt**：今天效果最好的一次提示词（原文引用）

如果没有明确的 Bad Practice 或 Best Prompt，可以基于工作内容合理推断。

---

## 第三步：用户信息

### 3.1 用户姓名
按以下优先级获取：
1. 从当前目录的 CLAUDE.md 或 ~/.claude/CLAUDE.md 中读取用户姓名
2. 从环境变量 `$USER` 或 `$LOGNAME` 读取
3. 如果以上都没有，询问用户

### 3.2 Agent 名称
默认为 "CC"（Claude Code 的缩写）。如果 CLAUDE.md 中有指定 agent 名称，则使用指定的。

### 3.3 工作目录
使用当前工作目录（`pwd`）。

---

## 第四步：HTML 生成

### 4.1 读取模板

读取模板文件：`~/.claude/skills/日报-让Agent秀/templates/report.html`

### 4.2 填充数据

将收集到的数据填入模板中的占位符。模板中使用 `{{VARIABLE_NAME}}` 格式的占位符，你需要替换为实际数据：

**Hero 区域**：
- `{{REPORT_TITLE}}` → 主题标题
- `{{REPORT_SUBTITLE}}` → 副标题
- `{{REPORT_DATE}}` → 日期（格式：2026年2月7日 · 星期六）
- `{{USER_NAME}}` → 用户姓名
- `{{AGENT_NAME}}` → Agent 名称

**Metrics 区域**（4 个指标卡片）：
- `{{METRIC_1_VALUE}}` → 文件产出数
- `{{METRIC_1_LABEL}}` → "文件产出"
- `{{METRIC_2_VALUE}}` → 新增行数
- `{{METRIC_2_UNIT}}` → " 行"
- `{{METRIC_2_LABEL}}` → "新增代码/文档"
- `{{METRIC_3_VALUE}}` → 活跃项目数
- `{{METRIC_3_LABEL}}` → "活跃项目"
- `{{METRIC_4_VALUE}}` → 核心产出数
- `{{METRIC_4_LABEL}}` → "核心产出"

**Achievements 区域**（3 个成就卡片）：
- `{{ACH_N_TAG}}` → 标签
- `{{ACH_N_TITLE}}` → 标题
- `{{ACH_N_DESC}}` → 描述
- `{{ACH_N_IMPACT}}` → 影响力

（N = 1, 2, 3）

**Insights 区域**：
- `{{GOOD_PRACTICE}}` → Good Practice 内容（支持 `<strong>` 标签加粗关键词）
- `{{BAD_PRACTICE}}` → Bad Practice 内容
- `{{BEST_PROMPT}}` → Best Prompt 原文

**Demos 区域**：
- 如果今天有 HTML demo 文件，填入 demo 卡片
- `{{DEMO_N_URL}}` → demo 文件显示路径
- `{{DEMO_N_SRC}}` → demo iframe src（相对路径）
- `{{DEMO_N_NAME}}` → demo 名称
- `{{DEMO_N_DESC}}` → demo 简述
- `{{DEMO_N_TAGS}}` → 技术标签，格式为 `<span class="demo-tag">HTML</span>` 元素
- 如果没有 demo，用无 demo 回退内容替换 demos 区域

**Task Rail**（背景任务流）：
- `{{TASK_RAIL_DATA}}` → 替换为 JavaScript 数组格式的任务时间线数据

**Footer**：
- `{{FOOTER_TEXT}}` → 底部文字，默认："Generated by Agent · Powered by <a href=\"#\">Claude Code</a> / Shiliu AI &copy; 2026"

### 4.3 处理 Demo 嵌入

查找今天修改的 HTML 文件中适合作为 demo 展示的（排除日报本身）：

```bash
find . -name "*.html" -mtime 0 -not -path '*/daily-reports/*' -not -path '*/node_modules/*' 2>/dev/null
```

最多选择 2 个最有代表性的 HTML demo 嵌入日报。如果没有 HTML demo，使用模板中的无 demo 回退内容。

将 demo 文件复制到日报目录下的 demos 子文件夹，确保 iframe 路径可用。

### 4.4 写入文件

将生成的 HTML 写入：
```
{当前工作目录}/daily-reports/{YYYY-MM-DD}/index.html
```

先创建目录：
```bash
mkdir -p ./daily-reports/$(date +%Y-%m-%d)
```

然后用 Write 工具写入 index.html。

如果有 demo 文件需要嵌入，复制到日报目录：
```bash
mkdir -p ./daily-reports/$(date +%Y-%m-%d)/demos
cp /path/to/demo.html ./daily-reports/$(date +%Y-%m-%d)/demos/
```

---

## 第五步：交付

### 5.1 启动本地预览服务器

在工作目录启动 HTTP 服务器（这样 demo iframe 可以正确加载）：

```bash
python3 -m http.server 8686 &
```

### 5.2 输出结果

向用户展示：

```
✅ 日报已生成！

📄 文件位置：./daily-reports/{日期}/index.html
🌐 预览地址：http://localhost:8686/daily-reports/{日期}/index.html

今日概览：
- 主题：{主题标题}
- 文件产出：{N} 个
- 新增代码：{N} 行
- 核心成就：{成就1}、{成就2}、{成就3}
```

---

## 注意事项

1. **一屏展示**：日报 HTML 设计为一屏展示（100vh），所有内容需在一个屏幕内可见，不要生成过多内容导致溢出。
2. **数据准确**：文件数、行数等指标需基于实际扫描结果，不要编造数据。
3. **中文为主**：日报内容以中文撰写，但标签/标题可以中英混用。
4. **优雅降级**：如果某些数据收集不到（如没有 git、没有 demo），优雅地跳过或使用默认值，不要报错。
5. **不重复询问**：尽量自动从环境中获取信息，减少对用户的打扰。只在真正缺少关键信息时才询问。
6. **标题简洁**：主题标题控制在 15 字以内，确保一行显示。用副标题补充细节。
